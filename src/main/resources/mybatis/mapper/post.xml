<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.somaeja.post.mapper.PostMapper">

    <insert id="save" parameterType="com.somaeja.post.entity.Post" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO POST
        (
            USER_ID,
            LOCATION_ID,
            IMAGE_ID,
            TITLE,
            CONTENT,
            PRICE,
            ISNEGOTIABLE,
            ISDIRECTTRADE,
            CREATEDATE,
            MODIFYDATE
        )
        VALUES
        (
            #{userId},
            #{locationId},
            #{imageId},
            #{title},
            #{content},
            #{price},
            #{isNegotiable},
            #{isOfflineTrade},
            #{createdDate},
            #{modifyDate}
        )
    </insert>

    <select id="findByAll" resultType="com.somaeja.post.entity.Post">
        SELECT
            POST_ID,
            USER_ID,
            LOCATION_ID,
            IMAGE_ID,
            TITLE,
            CONTENT,
            PRICE,
            ISNEGOTIABLE,
            ISDIRECTTRADE,
            CREATEDATE,
            MODIFYDATE
        FROM POST
    </select>

    <select id="findByTitle" resultType="com.somaeja.post.entity.Post" parameterType="string">
        SELECT
            POST_ID,
            USER_ID,
            LOCATION_ID,
            IMAGE_ID,
            TITLE,
            CONTENT,
            PRICE,
            ISNEGOTIABLE,
            ISDIRECTTRADE,
            CREATEDATE,
            MODIFYDATE
        FROM POST
        WHERE TITLE LIKE CONCAT('%',#{searchTitle},'%')
    </select>

    <select id="findByLocation" resultType="com.somaeja.post.entity.Post" parameterType="long">
        SELECT
            POST_ID,
            USER_ID,
            LOCATION_ID,
            IMAGE_ID,
            TITLE,
            CONTENT,
            PRICE,
            ISNEGOTIABLE,
            ISDIRECTTRADE,
            CREATEDATE,
            MODIFYDATE
        FROM POST
        WHERE LOCATION_ID = #{locationId}
    </select>

    <select id="findByUser" resultType="com.somaeja.post.entity.Post" parameterType="long">
        SELECT
            POST_ID,
            USER_ID,
            LOCATION_ID,
            IMAGE_ID,
            TITLE,
            CONTENT,
            PRICE,
            ISNEGOTIABLE,
            ISDIRECTTRADE,
            CREATEDATE,
            MODIFYDATE
        FROM POST
        WHERE USER_ID = #{userId}
    </select>

    <delete id="deletePost" parameterType="long">
        DELETE FROM POST WHERE POST_ID = #{postId}
    </delete>

    <update id="modifyPost" parameterType="com.somaeja.post.entity.Post">
        UPDATE POST SET
            LOCATION_ID = #{locationId},
            IMAGE_ID = #{imageId},
            TITLE = #{title},
            CONTENT = #{content},
            PRICE = #{price},
            ISNEGOTIABLE = #{isNegotiable},
            ISDIRECTTRADE = #{isOfflineTrade}
        WHERE POST_ID = #{id}
    </update>

</mapper>

